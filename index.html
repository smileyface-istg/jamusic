<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>JaMusic v2 | Premium Dashboard</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">

<style>
:root {
    --bg-dark: #020617;
    --accent: #38bdf8;
    --accent-glow: rgba(56,189,248,0.3);
    --card-bg: rgba(15,23,42,0.6);
    --sidebar-width: 280px;
}

body {
    font-family: 'Plus Jakarta Sans', sans-serif;
    background-color: var(--bg-dark);
    color: #f8fafc;
    margin: 0;
    overflow-x: hidden;
}

input[type="text"], input[type="email"], input[type="password"], textarea {
  color: inherit;
  caret-color: var(--accent);
}
::placeholder { color: rgba(255,255,255,0.5); }

::--webkit-scrollbar { width: 6px; }
::-webkit-scrollbar-track { background: var(--bg-dark); }
::-webkit-scrollbar-thumb { background: #1e293b; border-radius: 10px; }
::-webkit-scrollbar-thumb:hover { background: var(--accent); }

.glass {
    background: var(--card-bg);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border: 1px solid rgba(255,255,255,0.08);
}

.nav-active {
    background: linear-gradient(90deg, rgba(56, 189, 248, 0.15) 0%, rgba(56, 189, 248, 0) 100%);
    color: var(--accent);
    border-left: 3px solid var(--accent);
}

@keyframes fadeIn { from { opacity:0; transform: translateY(10px);} to{opacity:1; transform:translateY(0);} }
.animate-fade-in { animation: fadeIn 0.5s ease-out forwards; }

.music-card { transition: all 0.4s cubic-bezier(0.23,1,0.32,1); position: relative; z-index:10; }
.music-card:hover { transform: translateY(-10px) scale(1.02); background: rgba(255,255,255,0.1); box-shadow: 0 20px 40px rgba(0,0,0,0.4); }
.play-btn-float { opacity: 0; transform: translateY(20px); transition: all 0.3s ease; }
.music-card:hover .play-btn-float { opacity: 1; transform: translateY(0); }

#auth-overlay { position: fixed; inset: 0; z-index:10000; background: radial-gradient(circle at top right, #0f172a, #020617); display:flex; align-items:center; justify-content:center; transition: opacity 0.5s ease; }
#main-app.hidden-state { pointer-events:none; user-select:none; filter: blur(15px); opacity:0; }

input[type=range] { -webkit-appearance:none; background:transparent; }
input[type=range]::-webkit-slider-runnable-track { width:100%; height:4px; background:#334155; border-radius:2px; }
input[type=range]::-webkit-slider-thumb { -webkit-appearance:none; height:12px; width:12px; border-radius:50%; background:var(--accent); cursor:pointer; margin-top:-4px; box-shadow:0 0 10px var(--accent-glow); }
.visualizer-bar { transition: height 0.1s ease; }

.tab-btn { border-bottom: 2px solid transparent; padding-bottom:0.25rem; transition: all 0.3s ease; font-weight:600; color:#cbd5e1; }
.tab-btn.active { border-color: var(--accent); color:white; }

.profile-dropdown { opacity:0; transform:translateY(-10px); pointer-events:none; transition:all 0.2s ease; }
.profile-dropdown.active { opacity:1; transform:translateY(0); pointer-events:auto; }

#notif-banner { position: fixed; top:20px; left:50%; transform:translateX(-50%); background: linear-gradient(90deg,#38bdf8,#60a5fa,#38bdf8); color:white; font-weight:bold; font-style:italic; padding:12px 24px; border-radius:16px; box-shadow:0 8px 20px rgba(0,0,0,0.3); z-index:20000; opacity:0; animation:shine 1.8s infinite linear; }
@keyframes shine { 0%{background-position:0% 50%;}50%{background-position:100% 50%;}100%{background-position:0% 50%;} }

@media (max-width:768px){
    body{ font-size:14px;}
    #main-app{ padding:4px; }
    input, button { font-size:14px; }
}
</style>
</head>
<body>

<div id="auth-overlay" class="hidden">
    <!-- Login panel here -->
</div>

<div id="notif-banner">New Notifications!</div>

<aside class="fixed top-0 left-0 h-full w-[280px] glass hidden lg:flex flex-col z-50">
    <div class="p-8 h-full flex flex-col">
        <div class="flex items-center gap-3 mb-12">
            <div class="w-10 h-10 bg-blue-600 rounded-xl flex items-center justify-center shadow-lg shadow-blue-600/30">
                <svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 24 24"><path d="M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z"/></svg>
            </div>
            <span class="text-xl font-bold tracking-tighter">JaMusic</span>
        </div>

        <nav class="space-y-1 flex-1">
            <button class="nav-item w-full flex items-center gap-4 px-4 py-3.5 rounded-xl nav-active font-semibold transition-all">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path></svg>
                Discover
            </button>
            <button class="nav-item w-full flex items-center gap-4 px-4 py-3.5 rounded-xl text-slate-400 hover:text-white hover:bg-white/5 font-semibold transition-all">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path></svg>
                Trending
            </button>
            <button id="inbox-btn" class="nav-item w-full flex items-center gap-4 px-4 py-3.5 rounded-xl text-slate-400 hover:text-white hover:bg-white/5 font-semibold transition-all">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-width="2" d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4m18 0l-9-6-9 6M3 9h18"></path></svg>
                Inbox
            </button>
        </nav>

        <button onclick="logout()" class="nav-item w-full flex items-center gap-4 px-4 py-3.5 rounded-xl text-red-400 hover:bg-red-500/10 font-semibold transition-all mt-auto">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path></svg>
            Logout
        </button>
    </div>
</aside>

<!-- Main App -->
<div id="main-app" class="p-8 lg:ml-[280px]">
    <!-- Your original content goes here -->
    <header class="flex justify-between items-center mb-8">
        <h1 class="text-2xl font-bold">Welcome to JaMusic</h1>
        <div class="relative">
            <button id="profile-btn" class="p-2 rounded-full bg-gray-800 hover:bg-gray-700 transition-all">U</button>
            <div id="profile-dropdown" class="profile-dropdown absolute right-0 mt-2 w-56 glass rounded-xl p-4 flex flex-col space-y-2">
                <button id="display-name-btn" class="text-left px-3 py-2 hover:bg-white/5 rounded-lg">Display Name</button>
                <button class="text-left px-3 py-2 hover:bg-white/5 rounded-lg">Account Settings</button>
                <button class="text-left px-3 py-2 hover:bg-white/5 rounded-lg text-red-400">Logout</button>
            </div>
        </div>
    </header>

    <!-- Inbox panel -->
    <div id="inbox-panel" class="glass p-4 rounded-xl hidden absolute top-20 right-10 w-[360px] max-h-[400px] overflow-y-auto">
        <h2 class="text-lg font-bold mb-2">Inbox</h2>
        <div id="inbox-list" class="space-y-2 text-sm"></div>
    </div>

    <!-- Music content and other original components here -->
</div>

<!-- Display Name Modal -->
<div id="dn-overlay" class="hidden fixed inset-0 bg-black/70 z-50 flex items-center justify-center">
    <div id="dn-modal" class="bg-gray-900 rounded-xl p-6 w-[320px] space-y-4">
        <div id="dn-warning-view">
            <p>Hmm.. it looks like you are using an email username! That could lead to possible vulnerabilities! Change it?</p>
            <div class="flex justify-end gap-4 mt-2">
                <button id="dn-no" class="px-3 py-1 rounded-lg bg-gray-700 hover:bg-gray-600">No</button>
                <button id="dn-yes" class="px-3 py-1 rounded-lg bg-blue-600 hover:bg-blue-500">Yes</button>
            </div>
        </div>
        <div id="dn-input-view" class="hidden space-y-2">
            <p>Put your display name here (No special characters allowed)</p>
            <input type="text" id="dn-input" class="w-full p-2 rounded-lg bg-gray-800" />
            <div id="dn-error" class="text-red-500 text-sm hidden">Invalid name</div>
            <div class="flex justify-end gap-4">
                <button id="dn-cancel" class="px-3 py-1 rounded-lg bg-gray-700 hover:bg-gray-600">Cancel</button>
                <button id="dn-submit" class="px-3 py-1 rounded-lg bg-blue-600 hover:bg-blue-500">Submit</button>
            </div>
        </div>
    </div>
</div>

<script>
/* =============== Original Scripts =============== */

// Sidebar nav toggle
document.querySelectorAll('.nav-item').forEach(btn => {
    btn.addEventListener('click', ()=> {
        document.querySelectorAll('.nav-item').forEach(b=>b.classList.remove('nav-active'));
        btn.classList.add('nav-active');
    });
});

// Profile dropdown
const profileBtn = document.getElementById('profile-btn');
const profileDropdown = document.getElementById('profile-dropdown');
profileBtn.addEventListener('click', ()=> profileDropdown.classList.toggle('active'));

// Display name modal
const dnOverlay = document.getElementById('dn-overlay');
const dnModal = document.getElementById('dn-modal');
const dnWarningView = document.getElementById('dn-warning-view');
const dnInputView = document.getElementById('dn-input-view');
const dnYes = document.getElementById('dn-yes');
const dnNo = document.getElementById('dn-no');
const dnCancel = document.getElementById('dn-cancel');
const dnSubmit = document.getElementById('dn-submit');
const dnInput = document.getElementById('dn-input');
const dnError = document.getElementById('dn-error');

document.getElementById('display-name-btn').addEventListener('click', ()=>{
    dnOverlay.classList.remove('hidden');
    const userName = localStorage.getItem('jamusic_user') ? JSON.parse(localStorage.getItem('jamusic_user')).name : '';
    const isEmail = userName.includes('@');
    if(isEmail){ dnWarningView.classList.remove('hidden'); dnInputView.classList.add('hidden'); }
    else { dnWarningView.classList.add('hidden'); dnInputView.classList.remove('hidden'); dnInput.value = userName; setTimeout(()=>dnInput.focus(),50);}
});

// Display name modal actions
dnNo && dnNo.addEventListener('click', ()=> { dnOverlay.classList.add('hidden'); });
dnYes && dnYes.addEventListener('click', ()=>{
    dnWarningView.classList.add('hidden');
    dnInputView.classList.remove('hidden');
    dnError.classList.add('hidden');
    dnInput.value='';
    setTimeout(()=>dnInput.focus(),50);
});
dnCancel && dnCancel.addEventListener('click', ()=> dnOverlay.classList.add('hidden'));
dnSubmit && dnSubmit.addEventListener('click', ()=>{
    const val = (dnInput.value||'').trim();
    const r = /^[A-Za-z0-9 _-]{2,30}$/;
    if(!r.test(val)){ dnError.style.display='block'; return; }
    document.getElementById('dropdown-name').innerText = val;
    localStorage.setItem('jamusic_user', JSON.stringify({name:val,email:''}));
    dnOverlay.classList.add('hidden');
});

/* =============== Inbox system =============== */
const ADMIN_EMAIL = 'aidilzafri2013@gmail.com';
let inboxMessages = JSON.parse(localStorage.getItem('jamusic_inbox')||'[]');

function saveMessages(){ localStorage.setItem('jamusic_inbox', JSON.stringify(inboxMessages)); }
function renderInboxList(){
    const list = document.getElementById('inbox-list');
    list.innerHTML='';
    if(inboxMessages.length===0){ list.innerHTML='<p class="italic text-gray-400">You have no emails.</p>'; return; }
    inboxMessages.forEach(msg=>{
        const el = document.createElement('div');
        el.className='p-2 rounded-lg bg-gray-800 hover:bg-gray-700 cursor-pointer';
        el.innerText=msg.title;
        el.addEventListener('click', ()=>{
            alert(msg.subject+'\n\n'+msg.description);
        });
        list.appendChild(el);
    });
}

// Inbox toggle
document.getElementById('inbox-btn').addEventListener('click', ()=>{
    const panel = document.getElementById('inbox-panel');
    panel.classList.toggle('hidden');
    renderInboxList();
});

// Admin broadcast simulation
function adminBroadcast(title, subject, description){
    const msg = {id:Date.now(), title, subject, description};
    inboxMessages.push(msg);
    saveMessages();
    renderInboxList();
    // Banner notification
    const banner = document.getElementById('notif-banner');
    banner.innerText=`${title} NEW NOTIFICATIONS!`;
    banner.style.opacity=1;
    setTimeout(()=>banner.style.opacity=0,4000);
}

// Example: admin broadcast
if(JSON.parse(localStorage.getItem('jamusic_user')||'{}').email===ADMIN_EMAIL){
    adminBroadcast('Admin Message','Welcome','Hello everyone!');
}
</script>

</body>
</html>
